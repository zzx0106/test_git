{"version":3,"file":"pages/personal/withdrawal/withdrawal.js","sources":["webpack:///._src_pages_personal_withdrawal_withdrawal.tsx","webpack:///._src_pages_personal_withdrawal_withdrawal.module.scss","webpack:///./src/pages/personal/withdrawal/withdrawal.tsx?ade5"],"sourcesContent":["/*\r\n * @Description: 申请提现\r\n * @Date: 2021-08-23 15:58:30\r\n * @LastEditTime: 2021-09-08 16:16:40\r\n */\r\nimport { View, Text, Button } from '@tarojs/components';\r\nimport React, { useEffect, useState } from 'react';\r\nimport Taro from '@tarojs/taro';\r\nimport style from './withdrawal.module.scss';\r\nimport { api_find_account_balance, api_withdraw_cash } from '@/api/personal_center/personal_center';\r\nimport WX from '@/utils/WX';\r\nimport Loading from '@/components/loading/loading';\r\nimport Dialog from '@/components/dialog/dialog';\r\nimport { CSSModule } from '@/utils/css-module';\r\n\r\nconst Withdrawal = CSSModule(() => {\r\n  const [cash_amount, setCashAmount] = useState<number>(0);\r\n  const [withdraw_ing, setWithdrawIng] = useState<boolean>(false);\r\n  const [loading, setLoading] = useState<boolean>(true);\r\n  const [value, setValue] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setWithdrawIng(Taro.getStorageSync('setWithdrawIng'));\r\n    getFindBalance();\r\n  }, []);\r\n\r\n  // 获取余额\r\n  const getFindBalance = async () => {\r\n    try {\r\n      const res = await api_find_account_balance();\r\n      if (res) {\r\n        setCashAmount(res.cash_amount);\r\n        setLoading(false);\r\n      }\r\n    } catch (error) {\r\n      setLoading(false);\r\n      console.error('getFindBalance error', error);\r\n    }\r\n  };\r\n\r\n  // 余额流水记录\r\n  const bindRecords = () => {\r\n    Taro.navigateTo({\r\n      url: '/pages/personal/my-record-overage/my-record-overage',\r\n    });\r\n  };\r\n\r\n  // 申请提现按钮点击事件\r\n  const bindApply = () => {\r\n    if (cash_amount < 5000) {\r\n      toast('需满50元才可以提现哦~');\r\n    } else {\r\n      if (withdraw_ing) {\r\n        return;\r\n      }\r\n      getWithdrawCash();\r\n    }\r\n  };\r\n  // 请求提现接口\r\n  const getWithdrawCash = () => {\r\n    Taro.login({\r\n      success: async (res) => {\r\n        try {\r\n          await api_withdraw_cash(res.code);\r\n          toast('提现申请成功！我们将在三个工作日之内审核完成~');\r\n          setWithdrawIng(true);\r\n          getFindBalance();\r\n        } catch (error) {\r\n          WX.Toast(error.message);\r\n        }\r\n      },\r\n      fail: (err) => {\r\n        console.log(err);\r\n      },\r\n    });\r\n  };\r\n\r\n  const toast = (msg) => {\r\n    Taro.showToast({\r\n      title: msg,\r\n      icon: 'none',\r\n      duration: 3000,\r\n    });\r\n  };\r\n\r\n  return loading ? (\r\n    <Loading />\r\n  ) : (\r\n    <View styleName=\"apply-withdraw-container\">\r\n      <View styleName=\"apply-card-wrapper\">\r\n        <View styleName=\"flex\">\r\n          <View styleName=\"flex\">\r\n            <Text styleName=\"icon-jifen1x\" className=\"icon icon-jifen1x\"></Text>\r\n            <View styleName=\"left-text\">我的余额</View>\r\n          </View>\r\n          <View styleName=\"flex\" onClick={bindRecords}>\r\n            <Text styleName=\"right-text\">余额流水记录</Text>\r\n            <Text styleName=\"icon-jifenjiantou1x\" className=\"icon icon-jifenjiantou1x\"></Text>\r\n          </View>\r\n        </View>\r\n        <View styleName=\"credits\">\r\n          {cash_amount / 100}\r\n          <Text styleName=\"light\">元</Text>\r\n        </View>\r\n        <View styleName=\"tags\">\r\n          <Text styleName=\"tags-text\">已提现：50元</Text>\r\n          <Text styleName=\"tags-text\">累计最高可提现：99元</Text>\r\n        </View>\r\n        <Button\r\n          styleName={`apply-button ${cash_amount >= 5000 && !withdraw_ing ? 'apply-button-allow' : 'apply-button-not'}`}\r\n          onClick={bindApply}>\r\n          {withdraw_ing ? '申请提现中' : '申请提现'}\r\n        </Button>\r\n      </View>\r\n      <View styleName=\"content-message\">\r\n        <View styleName=\"title\">提现规则：</View>\r\n        <View styleName=\"info\">1、首次提现满50元即可申请提现，第二次提现满49即可申请提现；</View>\r\n        <View styleName=\"info\">2、单次提现最高为50元，最高可累计提现99元；</View>\r\n        <View styleName=\"info\">3、听书计划课程为104天课程，每日返现0.99，因此返现余额最高为102元，最终能提现99元；</View>\r\n        <View styleName=\"info\">4、每日只能提现一次；</View>\r\n        <View styleName=\"info\">5、如有疑问请添加客服：lihuatingshu001。</View>\r\n      </View>\r\n      <Dialog value={value} setValue={setValue} showClose>\r\n        <View styleName=\"wd-dialog\">\r\n          <View styleName=\"wd-dialog-title\">提现申请</View>\r\n          <View styleName=\"wd-dialog-subtitle\">提现额度：50元 </View>\r\n          <View styleName=\"wd-dialog-subtitle\">已累计提现：50元 </View>\r\n          <View styleName=\"wd-dialog-subtitle\">最终可提现：49元</View>\r\n          <View styleName=\"wd-dialog-subtitle\">（最高返现99元，因此本次提现为49元）</View>\r\n          <View styleName=\"wd-dialog-subtitle\">手续费：49*0.6%=0.29元 </View>\r\n          <View styleName=\"wd-dialog-subtitle\">实际到账：48.71元</View>\r\n          <View styleName=\"wd-dialog-subtitle margintop36\">我们将在3个工作日内审核您的提现，请耐心等待</View>\r\n          <View styleName=\"wd-dialog-btn\">确认提现</View>\r\n        </View>\r\n      </Dialog>\r\n    </View>\r\n  );\r\n}, style);\r\n\r\nexport default Withdrawal;\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"flex\":\"flex--1JwsU\",\"apply-withdraw-container\":\"apply-withdraw-container--rBdFs\",\"apply-card-wrapper\":\"apply-card-wrapper--1CJb1\",\"credits\":\"credits--30110\",\"tags\":\"tags--8TIMG\",\"tags-text\":\"tags-text--3Y7r3\",\"icon-jifen1x\":\"icon-jifen1x--3MKp8\",\"light\":\"light--3QToy\",\"left-text\":\"left-text--2xoqj\",\"apply-button\":\"apply-button--2Sp5l\",\"apply-button-allow\":\"apply-button-allow--nyNKT\",\"apply-button-not\":\"apply-button-not--2oRch\",\"right-text\":\"right-text--1YZyj\",\"icon-jifenjiantou1x\":\"icon-jifenjiantou1x--PmWFk\",\"title\":\"title--237GN\",\"info\":\"info--1snqN\",\"error-icon\":\"error-icon--1nm5z\",\"error-text\":\"error-text--3Zu7x\",\"wd-dialog\":\"wd-dialog--1iXbB\",\"wd-dialog-title\":\"wd-dialog-title--2ioWJ\",\"wd-dialog-subtitle\":\"wd-dialog-subtitle--1cPF3\",\"margintop36\":\"margintop36--MiDEq\",\"wd-dialog-btn\":\"wd-dialog-btn--1poIe\"};","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../../node_modules/babel-loader/lib/index.js!./withdrawal.tsx\"\nvar config = {\"navigationBarTitleText\":\"申请提现\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/personal/withdrawal/withdrawal', {root:{cn:[]}}, config || {}))\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAFA;AACA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AAPA;AAAA;AACA;AADA;AAAA;AAAA;AAQA;AACA;AACA;AAVA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAZA;AACA;AACA;AAwBA;AACA;AACA;AADA;AA3BA;AACA;AACA;AA+BA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AAAA;AACA;AAzCA;AACA;AACA;AA0CA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAGA;AACA;AACA;AALA;AAAA;AACA;AADA;AAAA;AAAA;AAOA;AACA;AARA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AADA;AAWA;AACA;AACA;AAbA;AADA;AACA;AAiBA;AACA;AACA;AACA;AACA;AAHA;AADA;AACA;AAOA;AAGA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAFA;AAIA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAFA;AALA;AAUA;AAAA;AAEA;AAAA;AAAA;AAFA;AAIA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAFA;AAKA;AACA;AAFA;AAAA;AAnBA;AAyBA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AANA;AAQA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AATA;AADA;AAlCA;AAzEA;AA4HA;;;;;;;;;;;;AC3IA;AACA;;;;;;;;;;;;;ACDA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;A","sourceRoot":""}