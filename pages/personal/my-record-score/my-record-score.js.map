{"version":3,"file":"pages/personal/my-record-score/my-record-score.js","sources":["webpack:///._src_pages_personal_my-record-score_my-record-score.tsx","webpack:///._src_pages_personal_my-record-score_my-record-score.module.scss","webpack:///./src/pages/personal/my-record-score/my-record-score.tsx?f5be"],"sourcesContent":["/*\r\n * @Description: 学分记录\r\n * @Date: 2021-08-24 10:28:29\r\n * @LastEditTime: 2021-08-31 11:00:37\r\n */\r\n\r\nimport { View, ScrollView, Text, Image } from '@tarojs/components';\r\nimport React, { useEffect, useState } from 'react';\r\nimport Loading from '@/components/loading/loading';\r\nimport { timeStream } from '@/utils/tools';\r\nimport style from './my-record-score.module.scss';\r\nimport { IMyRecordScore } from '@/api/personal_center/personal_center.i';\r\nimport { api_find_account_flows } from '@/api/personal_center/personal_center';\r\nimport Empty from '@/components/empty/empty';\r\nimport LoadMore from '@/components/load-more/load-more';\r\n\r\nconst MyRecordScore = () => {\r\n  const [loading, setLoading] = useState<boolean>(true);\r\n  let [offest, setOffest] = useState<number>(0);\r\n  const [is_last_page, setIsLastPage] = useState<boolean>(false);\r\n  const [is_load_interface, setIsLoadInterface] = useState<boolean>(false);\r\n  const [account_flows, setAccountFlows] = useState<IMyRecordScore.AccountFlow[]>([]);\r\n\r\n  useEffect(() => {\r\n    getFindAccountFlows();\r\n  }, []);\r\n\r\n  const getFindAccountFlows = async () => {\r\n    try {\r\n      const res = await api_find_account_flows(offest);\r\n      if (res) {\r\n        setAccountFlows([...account_flows, ...res.account_flows]);\r\n        setIsLastPage(res.is_last_page);\r\n        setIsLoadInterface(false);\r\n        setLoading(false);\r\n      }\r\n    } catch (error) {\r\n      setLoading(false);\r\n      console.error('getFindAccountFlows error', error);\r\n    }\r\n  };\r\n\r\n  // 加载下一页数据\r\n  const nextDataPage = () => {\r\n    if (is_load_interface || is_last_page) return;\r\n\r\n    offest = offest + 20;\r\n    setOffest(offest);\r\n    setIsLoadInterface(true);\r\n    getFindAccountFlows();\r\n  };\r\n\r\n  return loading ? (\r\n    <Loading />\r\n  ) : (\r\n    <>\r\n      <View className={style.top_line}></View>\r\n      <ScrollView className={style.scroll_view_container} scrollY onScrollToLower={nextDataPage}>\r\n        <View className={style.unit_record_container}>\r\n          {account_flows.length ? (\r\n            <>\r\n              {account_flows.map((item, index) => {\r\n                return (\r\n                  <View className={`${style.item_content} ${style.flex}`} key={index}>\r\n                    <View className={style.flex}>\r\n                      <Text className={`icon icon-xuefen ${style.item_icon}`}></Text>\r\n                      <View>\r\n                        <View className={style.item_title}>{item.remark}</View>\r\n                        <View className={style.item_date}>{timeStream(item.create_ts * 1000)}</View>\r\n                      </View>\r\n                    </View>\r\n                    <View className={style.point}>{(item.account_change_type === 1 ? '+' : '-') + item.amount + '分'}</View>\r\n                  </View>\r\n                );\r\n              })}\r\n              <View className={style.bottom_line}>\r\n                <LoadMore is_last_page={is_last_page} />\r\n              </View>\r\n            </>\r\n          ) : (\r\n            <Empty />\r\n          )}\r\n        </View>\r\n      </ScrollView>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default MyRecordScore;\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"unit_record_container\":\"unit_record_container--3aTAW\",\"top_line\":\"top_line--2vgcF\",\"item_icon\":\"item_icon--2Mdcs\",\"item_content\":\"item_content--2Gbi3\",\"item_title\":\"item_title--QPlYG\",\"item_date\":\"item_date--3CpeC\",\"scroll_view_container\":\"scroll_view_container--1GDYP\",\"point\":\"point--184M7\",\"bottom_line\":\"bottom_line--3QAsA\",\"flex\":\"flex--2bCBM\"};","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../../node_modules/babel-loader/lib/index.js!./my-record-score.tsx\"\nvar config = {\"navigationBarTitleText\":\"学分记录\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/personal/my-record-score/my-record-score', {root:{cn:[]}}, config || {}))\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;;;;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AADA;AACA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAAA;AACA;AADA;AAAA;AAAA;AAUA;AACA;AACA;AAZA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAXA;AACA;AACA;AAyBA;AACA;AAEA;AACA;AACA;AACA;AANA;AACA;AAQA;AAGA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAEA;AAEA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAFA;AAFA;AAOA;AAAA;AAAA;AARA;AAHA;AAeA;AAAA;AACA;AAAA;AADA;AAfA;AAFA;AADA;AAFA;AAvCA;AACA;AAuEA;;;;;;;;;;;;ACxFA;AACA;;;;;;;;;;;;;ACDA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;A","sourceRoot":""}